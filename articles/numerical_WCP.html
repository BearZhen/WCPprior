<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Numerical approximations of WCP priors ‚Ä¢ WCPprior</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Numerical approximations of WCP priors">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WCPprior</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/numerical_WCP.html">Numerical approximations of WCP priors</a></li>
    <li><a class="dropdown-item" href="../articles/INLA_and_Stan_utilities.html">Bridge to R-INLA and Stan</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vpnsctl/WCPprior/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Numerical approximations of WCP priors</h1>
            
            <h4 data-toc-skip class="date">Created: 2023-12-13. Last
modified: 2024-07-14.</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vpnsctl/WCPprior/blob/devel/vignettes/numerical_WCP.Rmd" class="external-link"><code>vignettes/numerical_WCP.Rmd</code></a></small>
      <div class="d-none name"><code>numerical_WCP.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we will show how to use the WCPprior package to
obtain 1D and 2D numerical and analytic WCP prior.</p>
<p>Import relevant libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vpnsctl.github.io/WCPprior/">WCPprior</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="bivariate-wcp_2-prior-of-mean-and-standard-deviation-of-gaussian-distribution-">Bivariate
WCP<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi></mi><mn>2</mn></msub><annotation encoding="application/x-tex">_2</annotation></semantics></math>
prior of mean and standard deviation of Gaussian distribution.<a class="anchor" aria-label="anchor" href="#bivariate-wcp_2-prior-of-mean-and-standard-deviation-of-gaussian-distribution-"></a>
</h2>
<p>The theoretical details of deriving bivariate WCP prior density can
be found on Recipe 1, Section 4.2 from <a href="https://arxiv.org/pdf/2312.04481.pdf" class="external-link uri">https://arxiv.org/pdf/2312.04481.pdf</a>, and its
implementation details can be found on Recipe 4, Section 5.2 from the
same document.</p>
<p>The function that gives numerical approximation of bivariate WCP
prior requires some information.<br></p>
<ol style="list-style-type: decimal">
<li>A function that takes values of the two-dimensional parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùõâ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∏</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Œ∏</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} = (\theta_1, \theta_2)</annotation></semantics></math>
and returns the Wasserstein distance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùõâ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">W(\boldsymbol{\theta})</annotation></semantics></math>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
the user-specified hyperparameter for WCP prior.</li>
<li>cutoff parameter that determines upper bound of the Wasserstein
distance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math>
in case of the parameter space
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõâ</mi><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math>
is unbounded. That is, by solving
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>W</mi><mo>&gt;</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">cutoff</mtext></mrow><annotation encoding="application/x-tex">P(W &gt; w) = \text{cutoff}</annotation></semantics></math>,
the upper bound
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mo>‚àí</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">cutoff</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>Œ∑</mi></mrow><annotation encoding="application/x-tex">w = -log(\text{cutoff})/\eta</annotation></semantics></math>.
Thus, we can approximate the WCP prior on a bounded domain.<br>
</li>
<li>region information that specifies boundary of the bounded domain of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõâ</mi><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math>
determined by cutoff, type of shape of the domain.<br>
</li>
<li>mesh width that determine how fine the mesh is on the bounded
domain.<br>
</li>
</ol>
<p>Let us define the Wasserstein distance function, where
<code>x[1]</code> is the mean parameter, <code>x[2]</code> is the
standard deviation parameter:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">W_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>We now define the parameters and the region:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cutoff</span> <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="va">mesh_width</span> <span class="op">=</span> <span class="fl">0.3</span></span>
<span><span class="co"># user-specified hyperparameter</span></span>
<span><span class="va">eta</span> <span class="op">=</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">region</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'conic'</span>, lower_angle <span class="op">=</span> <span class="fl">0</span>, </span>
<span>upper_angle <span class="op">=</span> <span class="va">pi</span>, base_theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Observe that the type of region is <code>conic</code>, the range of
the angle of the conic region is from 0 to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÄ</mi><annotation encoding="application/x-tex">\pi</annotation></semantics></math>
and the base model parameter is <code>(0,0)</code>.</p>
<p>The following code performs the approximation by using the
<code><a href="../reference/WCP_2D_Numerical_Density.html">WCP_2D_Numerical_Density()</a></code> function. By setting
<code>parallel = TRUE</code>, user can run the function with multiple
cores and <code>NumCores</code> specifies number of cores. We will set
<code>visual_mesh = TRUE</code> to obtain a plot of the region along
with the constructed mesh.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="../reference/WCP_2D_Numerical_Density.html">WCP_2D_Numerical_Density</a></span><span class="op">(</span><span class="va">W_func</span>,</span>
<span>                          eta <span class="op">=</span> <span class="va">eta</span>,</span>
<span>                          mesh_width <span class="op">=</span> <span class="va">mesh_width</span>, </span>
<span>                          cutoff <span class="op">=</span> <span class="va">cutoff</span>, </span>
<span>                          region <span class="op">=</span> <span class="va">region</span>,</span>
<span>                          parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          NumCores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                          visual_mesh <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="numerical_WCP_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>This function returns the values of the approximated density along
the level curves. Our goal now is to plot the approximated density. To
this end, we will obtain the approximated values at the mesh, then plot
its values on a pixelated cover of the mesh.</p>
<p>We begin by extracting the mesh and creating a pixelized mesh with
the <code><a href="https://inlabru-org.github.io/fmesher/reference/fm_pixels.html" class="external-link">fm_pixels()</a></code> function from the <code>fmesher</code>
package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inlabru-org.github.io/fmesher/" class="external-link">fmesher</a></span><span class="op">)</span></span>
<span><span class="va">mesh</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">mesh</span></span>
<span><span class="va">pxl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_pixels.html" class="external-link">fm_pixels</a></span><span class="op">(</span><span class="va">mesh</span><span class="op">)</span></span></code></pre></div>
<p>We will now obtain the values of the approximated density at the mesh
nodes. To this end, we need the elements <code>basis</code> and
<code>val</code> from the returned list. The <code>basis</code> contains
the matrix that maps the level curve locations to the mesh nodes, and
<code>val</code> contains the values of the approximated density at the
level curve locations.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">basis</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">basis</span></span>
<span><span class="va">dens_val</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">val</span> </span>
<span><span class="va">dens_mesh</span> <span class="op">&lt;-</span> <span class="fu">basis</span><span class="op">(</span><span class="va">dens_val</span><span class="op">)</span></span></code></pre></div>
<p>Let us obtain the values of the approximated density at the pixelated
mesh:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pxl</span><span class="op">$</span><span class="va">val</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://inlabru-org.github.io/fmesher/reference/fm_evaluate.html" class="external-link">fm_evaluate</a></span><span class="op">(</span><span class="va">mesh</span>, <span class="va">pxl</span>, field <span class="op">=</span> </span>
<span>      <span class="va">dens_mesh</span><span class="op">)</span></span></code></pre></div>
<p>Let us now plot the approximated density in log scale:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">pxl</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="numerical_WCP_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Now we show the absolute error between the true and the approximated
densities. We begin by obtaining the values of the true density at the
pixelated locations:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="va">coord_pxl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">pxl</span><span class="op">)</span></span>
<span><span class="co"># compute the true density</span></span>
<span><span class="va">true_WCP_density</span> <span class="op">=</span> <span class="op">(</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">coord_pxl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> </span>
<span>                <span class="va">coord_pxl</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span> <span class="op">*</span> <span class="va">eta</span> <span class="op">*</span> </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">eta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">coord_pxl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> </span>
<span>                <span class="va">coord_pxl</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">pi</span></span></code></pre></div>
<p>We can now add the absolute errors at the <code>pxl</code> list:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pxl</span><span class="op">$</span><span class="va">error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">pxl</span><span class="op">$</span><span class="va">val</span> <span class="op">-</span> <span class="va">true_WCP_density</span><span class="op">)</span></span></code></pre></div>
<p>Now, the error plot in log scale:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">pxl</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="numerical_WCP_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>To compute the total variation distance between the true and
approximated distribution, we can do the following. We start by obtainig
the lumped mass matrix, which is a matrix that contains the areas of the
triangles of the mesh:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass_lump_C</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">C</span></span></code></pre></div>
<p>Let us now obtain the value of the true density at the mesh
locations:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_WCP_density_mesh</span> <span class="op">=</span> <span class="op">(</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mesh</span><span class="op">$</span><span class="va">loc</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> </span>
<span>                <span class="va">mesh</span><span class="op">$</span><span class="va">loc</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span> <span class="op">*</span> <span class="va">eta</span> <span class="op">*</span> </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">eta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mesh</span><span class="op">$</span><span class="va">loc</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> </span>
<span>                <span class="va">mesh</span><span class="op">$</span><span class="va">loc</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">pi</span></span></code></pre></div>
<p>We can now compute the approximation of the total variation norm:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TVD_error</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mass_lump_C</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">dens_mesh</span>,ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">true_WCP_density_mesh</span>,ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="va">cutoff</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">TVD_error</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.01822381</span></span></code></pre>
<p>The <code>WCPprior</code> package also provides a function to compute
point-wise analytic bivariate
WCP<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi></mi><mn>2</mn></msub><annotation encoding="application/x-tex">_2</annotation></semantics></math>
prior of mean and standard deviation of Gaussian distribution. To use
this function, users just need to provide values of parameters,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
and base model mean parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">base_mean</mtext><annotation encoding="application/x-tex">\text{base_mean}</annotation></semantics></math>.
The base model standard deviation parameter is fixed to 0. Now we use
this function to compute the densities on all the coordinates where the
numerical approximation densities are computed.</p>
<p>Let us start by obtaining the analytic density with the help of the
<code><a href="../reference/WCP2_2D_Gaussian_analytic.html">WCP2_2D_Gaussian_analytic()</a></code> function</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analytic_density</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">coord_pxl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">analytic_density</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> </span>
<span>            <span class="fu"><a href="../reference/WCP2_2D_Gaussian_analytic.html">WCP2_2D_Gaussian_analytic</a></span><span class="op">(</span>mean <span class="op">=</span> </span>
<span>                      <span class="va">coord_pxl</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>, </span>
<span>                      std <span class="op">=</span> <span class="va">coord_pxl</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                      eta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      base_mean <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Let us now compare the above density with the true density we
computed manually:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_WCP_density</span> <span class="op">-</span> <span class="va">analytic_density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<p>We will now plot the analytic density:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">coord_pxl</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">coord_pxl</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">analytic_density</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colourbar</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">'cm'</span><span class="op">)</span>, <span class="co">#change legend key height</span></span>
<span>        legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">'cm'</span><span class="op">)</span>, <span class="co">#change legend key width</span></span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">7</span><span class="op">)</span>, <span class="co">#change legend title font size</span></span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,<span class="co">#change legend text font size</span></span>
<span>        axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>        axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">g</span></span></code></pre></div>
<p><img src="numerical_WCP_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="wcp_2-prior-of-reciprocal-of-degree-of-freedom-of-t-distribution-">WCP<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi></mi><mn>2</mn></msub><annotation encoding="application/x-tex">_2</annotation></semantics></math>
prior of reciprocal of degree of freedom of t-distribution.<a class="anchor" aria-label="anchor" href="#wcp_2-prior-of-reciprocal-of-degree-of-freedom-of-t-distribution-"></a>
</h2>
<p>The theoretical implementation details of
WCP<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi></mi><mn>2</mn></msub><annotation encoding="application/x-tex">_2</annotation></semantics></math>
prior of reciprocal of degree of freedom parameter of t-distribution can
be found at Section 5.1 from <a href="https://arxiv.org/pdf/2312.04481.pdf" class="external-link uri">https://arxiv.org/pdf/2312.04481.pdf</a>. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œæ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
denote the parameter of interest. To use our function to construct
numerical approximation of WCP prior of a single parameter, users need
to provide the following information in general:<br>
(1), A function that takes values of the two-dimensional parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∏</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
and returns the Wasserstein distance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">W(\theta)</annotation></semantics></math>.<br>
(2),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\theta_0</annotation></semantics></math>,
the base model parameter. (3),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>,
the user-specified hyperparameter for WCP prior.<br>
(4), cutoff parameter.<br>
(5), Lower and upper bound of the domain of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∏</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
and if the two values are included or not.<br></p>
<p>Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œæ</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\xi\in[0,1/2)</annotation></semantics></math>
is a bounded domain, we do not need to provide the cutoff parameter in
this case. Also, an analytic expression of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œæ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">W(\xi)</annotation></semantics></math>
is not available in our case, we have to compute it numerically by
numerical integration (see Remark 1 from <a href="https://arxiv.org/pdf/2312.04481.pdf" class="external-link uri">https://arxiv.org/pdf/2312.04481.pdf</a>).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://geobosh.github.io/fGarchDoc/" class="external-link">fGarch</a></span><span class="op">)</span></span>
<span><span class="co"># The Wasserstein distance function by numerical integration</span></span>
<span><span class="va">W2distanceGt</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xi</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># xi is 1/nu where nu is dof of t-distribution</span></span>
<span>  <span class="va">integrand</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://geobosh.github.io/fGarchDoc/reference/dist-std.html" class="external-link">qstd</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">...</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">integral</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html" class="external-link">Vectorize</a></span><span class="op">(</span><span class="va">integrand</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fl">1</span>, </span>
<span>      nu <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">xi</span>,subdivisions <span class="op">=</span> <span class="fl">10000L</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="va">integral</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>However, to call the above function frequently is not economic, we
construct an interpolated function for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œæ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">W(\xi)</annotation></semantics></math>
by the following code.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a sequence of xi</span></span>
<span><span class="va">Xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.01</span>,to <span class="op">=</span> <span class="fl">0.49</span>,by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="co"># obtain a sequence of W(xi) by W2distanceGt function</span></span>
<span><span class="va">W2distance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Xi</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># skip the case of problematic numerical integration</span></span>
<span>  <span class="va">temp</span> <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">W2distanceGt</span><span class="op">(</span><span class="va">Xi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="st">'try-error'</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">next</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">W2distance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">W2distance</span>, <span class="fu">W2distanceGt</span><span class="op">(</span><span class="va">Xi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">xi</span>, <span class="va">Xi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># the interpolated function of W(xi)</span></span>
<span><span class="va">W2d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/splinefun.html" class="external-link">splinefun</a></span><span class="op">(</span><span class="va">xi</span>, <span class="va">W2distance</span>, method <span class="op">=</span> <span class="st">"hyman"</span><span class="op">)</span></span></code></pre></div>
<p>We determine
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∑</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
by requiring
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">W</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œæ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mi>U</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">P(\text{W}(\xi) &gt; U) = \alpha</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.3</span></span>
<span><span class="va">U</span> <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="va">eta</span> <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span><span class="op">/</span><span class="fu">W2d</span><span class="op">(</span><span class="va">U</span><span class="op">)</span></span></code></pre></div>
<p>Now we are ready to call the function to compute numerically
approximated WCP prior.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">base_theta</mtext><annotation encoding="application/x-tex">\text{base_theta}</annotation></semantics></math>
is the base model parameter.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">L</mtext><annotation encoding="application/x-tex">\text{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">U</mtext><annotation encoding="application/x-tex">\text{U}</annotation></semantics></math>
denote lower and upper bound of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∏</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">L_included</mtext><annotation encoding="application/x-tex">\text{L_included}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">U_included</mtext><annotation encoding="application/x-tex">\text{U_included}</annotation></semantics></math>
indicate if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">L</mtext><annotation encoding="application/x-tex">\text{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">U</mtext><annotation encoding="application/x-tex">\text{U}</annotation></semantics></math>
should be included into the interval of the parameter of interest.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">mesh_width</mtext><annotation encoding="application/x-tex">\text{mesh_width}</annotation></semantics></math>
denote mesh width of the domain. User may instead input
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtext mathvariant="normal">mesh_n</mtext><annotation encoding="application/x-tex">\text{mesh_n}</annotation></semantics></math>
which specifies number of mesh nodes to determine the mesh.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="../reference/WCP_1D_Numerical_Density.html">WCP_1D_Numerical_Density</a></span><span class="op">(</span>base_theta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                   L <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                                   L_included <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   U <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                   U_included <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                   W_func <span class="op">=</span> <span class="va">W2d</span>,</span>
<span>                                   eta <span class="op">=</span> <span class="va">eta</span>,</span>
<span>                                   mesh_width <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></code></pre></div>
<p>The output contains a vector of values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œæ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
and a vector approximated densities evaluated at those
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œæ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>.
The visualization of the result is:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">result</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, density <span class="op">=</span> <span class="va">result</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="numerical_WCP_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Bolin, Alexandre Simas, Zhen Xiong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
